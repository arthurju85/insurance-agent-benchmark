# 需求变更记录

> 本文档记录保险智能体评测系统所有需求变更历史
> 每次需求变更必须在此文档中登记

---

## 变更记录模板

```markdown
### 变更编号：REQ-YYYY-MM-DD-XXX

**变更日期**: YYYY-MM-DD
**变更类型**: [新增/修改/删除/优化]
**提出人**:
**影响范围**:
**优先级**: [P0/P1/P2/P3]
**状态**: [已评审/开发中/已完成/已取消]

**变更内容**:
-

**变更原因**:
-

**涉及文件**:
-

**测试结果**:
-

**相关文档更新**:
- [ ] PRD.md
- [ ] PRD.docx
- [ ] API 文档
- [ ] 用户手册
```

---

## 变更历史

### 变更编号：REQ-2026-02-24-001

**变更日期**: 2026-02-24
**变更类型**: 初始版本
**提出人**: 产品团队
**影响范围**: 整个系统
**优先级**: P0
**状态**: 已完成

**变更内容**:
1. 完成核心评测流水线开发
   - 五维度评测（知识/理解/推理/合规/工具）
   - 多线程并行执行
   - 自动评分和报告生成

2. 完成沙箱系统开发
   - OpenAI API 适配器
   - Azure OpenAI 适配器
   - 本地模型适配器（vLLM）

3. 完成数据持久化模块
   - SQLite 数据库设计
   - 评测结果自动保存
   - 历史趋势分析

4. 完成题目变异引擎
   - 数值变异（日期/金额/年龄）
   - 实体替换（人名/公司名）
   - 句式重组

5. 完成数据爬虫系统
   - 银保监会政策爬虫
   - 保险公司条款爬虫
   - 条款结构化解析

6. 完成管理员后台
   - 仪表盘数据概览
   - 题目 CRUD 管理
   - 评测监控
   - 系统配置

**变更原因**:
- 建立保险 Agent 评测的完整平台
- 提供标准化评测流程
- 支持防污染的题目变异

**涉及文件**:
- `backend/src/pipeline/`
- `backend/src/sandbox/`
- `backend/src/db/`
- `backend/src/crawler/`
- `backend/src/api/`

**测试结果**:
- ✅ 数据库测试通过
- ✅ 变异引擎测试通过
- ✅ 爬虫系统测试通过
- ✅ 管理员后台测试通过

**相关文档更新**:
- [x] PRD.md
- [x] PRD.docx
- [ ] API 文档 (自动生成)
- [ ] 用户手册 (待创建)

---

### 变更编号：REQ-2026-02-24-002

**变更日期**: 2026-02-24
**变更类型**: 新增
**提出人**: 用户反馈
**影响范围**: 前端页面、后端 API、管理员后台
**优先级**: P2
**状态**: 已完成

**变更内容**:
1. 新增评测方法论文档页面 (/docs)
   - 五维度评测体系展示
   - 评分机制说明
   - 题目类型介绍
   - 防污染设计说明

2. 新增 Agent 提交页面 (/submit)
   - 在线申请表单
   - 表单验证
   - 提交状态反馈

3. 新增提交审核 API 和管理员后台
   - POST /api/v1/submissions/ - 提交申请
   - GET /api/v1/submissions/ - 获取提交列表
   - GET/PUT /api/v1/submissions/{id} - 提交详情/审核
   - GET /api/v1/admin/submissions - 管理员审核列表

4. 新增 API 限流中间件
   - 同 IP 24 小时内最多提交 3 次
   - 防止恶意提交轰炸

5. 新增 i18n 翻译支持
   - 文档页面翻译（中/繁/英）
   - 提交页面翻译（中/繁/英）

**变更原因**:
- 提升评测体系专业性展示
- 允许外部提交 Agent 参与评测
- 防止恶意提交攻击

**涉及文件**:
- `frontend/app/docs/page.tsx` (新建)
- `frontend/app/submit/page.tsx` (新建)
- `frontend/lib/i18n.tsx` (修改)
- `frontend/components/site-header.tsx` (修改)
- `backend/src/api/submissions.py` (新建)
- `backend/src/api/routes/submissions.py` (新建)
- `backend/src/middleware/rate_limiter.py` (新建)
- `backend/src/api/admin.py` (修改)
- `backend/src/api/routes/admin.py` (修改)

**测试结果**:
- ✅ 文档页面渲染正常
- ✅ 提交表单验证正常
- ✅ API 限流功能正常
- ✅ 管理员后台审核功能正常

**相关文档更新**:
- [x] PRD.md
- [x] CHANGELOG.md

---

## 待处理变更

### 变更编号：REQ-2026-02-24-003

**变更日期**: 2026-02-24
**变更类型**: 新增
**提出人**: 产品团队
**影响范围**: API 层
**优先级**: P1
**状态**: 待评审

**变更内容**:
- 实现 JWT 认证机制
- 添加用户权限管理
- API 访问日志记录

**变更原因**:
- 生产环境需要安全认证
- 防止未授权访问

**涉及文件**:
- `backend/src/api/auth.py` (新建)
- `backend/src/api/main.py` (修改)

**测试结果**:
- 待测试

**相关文档更新**:
- [ ] PRD.md
- [ ] PRD.docx
- [ ] API 文档
- [ ] 部署文档

---

## 变更统计

| 统计项 | 数量 |
|--------|------|
| 总变更数 | 2 |
| 已完成 | 2 |
| 开发中 | 0 |
| 待评审 | 1 |
| 已取消 | 0 |

### 按类型统计

| 类型 | 数量 |
|------|------|
| 新增 | 2 |
| 修改 | 0 |
| 删除 | 0 |
| 优化 | 0 |

### 按优先级统计

| 优先级 | 数量 |
|--------|------|
| P0 | 1 |
| P1 | 1 |
| P2 | 1 |
| P3 | 0 |

---

## 变更流程

### 1. 提交变更
- 填写变更申请（使用上方模板）
- 在"待处理变更"区域添加记录
- 分配变更编号

### 2. 评审变更
- 产品负责人评审
- 技术负责人评审
- 更新状态为"已评审"

### 3. 开发实施
- 更新状态为"开发中"
- 按变更内容开发
- 完成测试

### 4. 文档更新
- 更新 PRD.md
- 更新 PRD.docx
- 更新 API 文档
- 更新用户手册（如需要）

### 5. 完成归档
- 更新状态为"已完成"
- 移动到"变更历史"区域
- 更新统计信息

---

**最后更新**: 2026-02-24
**文档维护人**: 产品团队
